<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì›ì£¼ê°ê³¼ ì¤‘ì‹¬ê° | Inscribed & Central Angles</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        /* 1. ê³µí†µ ì„¤ì • */
        body {
            font-family: 'Jua', sans-serif;
            margin: 0; padding: 0;
            background: radial-gradient(circle at 50% 30%, #a29bfe, #6c5ce7); /* ë³´ë¼ìƒ‰ í…Œë§ˆ */
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; user-select: none;
        }

        /* 2. í—¤ë” */
        header {
            background: rgba(255, 255, 255, 0.9);
            width: 100%; padding: 15px 0;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative;
        }
        .home-btn {
            position: absolute; left: 20px;
            background: #2d3436; color: white; border: none;
            padding: 8px 15px; border-radius: 20px; cursor: pointer; 
            font-family: 'Jua'; text-decoration: none; font-size: 1rem;
        }
        h1 { margin: 0; font-size: 1.8rem; color: #2d3436; }

        /* 3. ê²Œì„ ì˜ì—­ */
        .container {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; width: 100%; max-width: 600px;
            padding: 20px; box-sizing: border-box;
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 30px; border-radius: 20px; margin-bottom: 20px;
            text-align: center; border: 2px solid white; color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%; max-width: 400px;
        }
        .angle-display {
            font-size: 1.5rem; margin: 5px 0;
            display: flex; justify-content: space-between;
        }
        .angle-val { font-weight: bold; font-size: 1.8rem; }
        .red-text { color: #ff7675; text-shadow: 1px 1px 0 #fff; } /* ì¤‘ì‹¬ê° ìƒ‰ */
        .blue-text { color: #74b9ff; text-shadow: 1px 1px 0 #fff; } /* ì›ì£¼ê° ìƒ‰ */

        /* ìº”ë²„ìŠ¤ ë˜í¼ */
        .canvas-wrapper {
            background: white; border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            padding: 20px; position: relative;
        }
        canvas { display: block; border-radius: 20px; cursor: pointer; }

        /* 4. ì ‘ì´ì‹ ê°œë…ë…¸íŠ¸ */
        .concept-wrapper {
            width: 100%; max-width: 600px; margin: 30px auto;
            box-sizing: border-box; padding: 0 20px;
        }
        .concept-btn {
            width: 100%; padding: 15px 25px;
            background: white; border: none; border-radius: 20px;
            color: #2d3436; font-family: 'Jua'; font-size: 1.2rem;
            cursor: pointer; text-align: left;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: flex; justify-content: space-between; align-items: center;
            transition: all 0.2s;
        }
        .concept-btn:hover { background: #f1f2f6; transform: translateY(-2px); }
        .concept-btn.active { 
            background: #6c5ce7; color: white; 
            border-radius: 20px 20px 0 0; 
        }
        
        .concept-content {
            max-height: 0; overflow: hidden; 
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0 0 20px 20px;
            box-shadow: 0 10px 15px rgba(0,0,0,0.05);
            transition: max-height 0.3s ease-out;
        }
        .concept-inner { padding: 25px; line-height: 1.6; color: #2d3436; }
        .arrow-icon { transition: transform 0.3s; }
        .concept-btn.active .arrow-icon { transform: rotate(180deg); }

    </style>
</head>
<body>

    <header>
        <a href="../../index.html" class="home-btn">ğŸ  í™ˆ</a>
        <h1>ğŸ”µ ì›ì£¼ê°ê³¼ ì¤‘ì‹¬ê°</h1>
    </header>

    <div class="container">
        
        <div class="info-panel">
            <div class="angle-display">
                <span style="display:flex; align-items:center;">ğŸ”´ ì¤‘ì‹¬ê° (âˆ AOB)</span>
                <span class="angle-val red-text" id="centerAngle">--Â°</span>
            </div>
            <div class="angle-display">
                <span style="display:flex; align-items:center;">ğŸ”µ ì›ì£¼ê° (âˆ APB)</span>
                <span class="angle-val blue-text" id="inscribedAngle">--Â°</span>
            </div>
        </div>

        <div class="canvas-wrapper">
            <canvas id="geoCanvas" width="600" height="600" style="width:300px; height:300px;"></canvas>
            <div style="text-align: center; margin-top: 10px; color: #b2bec3; font-size: 0.9rem;">
                * ì  A, B, Pë¥¼ ë“œë˜ê·¸í•´ì„œ ì›€ì§ì—¬ë³´ì„¸ìš”!
            </div>
        </div>

    </div>

    <div class="concept-wrapper">
        <button class="concept-btn" onclick="toggleConcept()">
            <span>ğŸ“˜ ì„ ìƒë‹˜ì˜ ê°œë… ë…¸íŠ¸ (í´ë¦­!)</span>
            <span class="arrow-icon">â–¼</span>
        </button>
        
        <div class="concept-content" id="conceptBox">
            <div class="concept-inner">
                <h3 style="color: #6c5ce7; margin-top:0;">1. ì›ì£¼ê°ê³¼ ì¤‘ì‹¬ê°ì˜ ê´€ê³„</h3>
                <p>
                    í•œ ì›ì—ì„œ <b>ê°™ì€ í˜¸</b>ì— ëŒ€í•œ <b>ì›ì£¼ê°ì˜ í¬ê¸°</b>ëŠ” <b>ì¤‘ì‹¬ê°ì˜ í¬ê¸°ì˜ 1/2</b>ì…ë‹ˆë‹¤.<br>
                    ë°˜ëŒ€ë¡œ, ì¤‘ì‹¬ê°ì˜ í¬ê¸°ëŠ” ì›ì£¼ê°ì˜ 2ë°°ê°€ ë˜ê² ì£ ?
                </p>
                <div style="background:#dfe6e9; padding:10px; border-radius:10px; text-align:center; font-weight:bold; color:#2d3436; margin: 15px 0;">
                    âˆ AOB = 2 Ã— âˆ APB
                </div>

                <h3 style="color: #6c5ce7; margin-top: 20px;">2. ì›ì£¼ê°ì˜ ì„±ì§ˆ</h3>
                <p>
                    í˜¸ ABê°€ ê³ ì •ë˜ì–´ ìˆë‹¤ë©´, ì  Pê°€ ì› ìœ„ ì–´ë””ì— ìˆë“ (ê°™ì€ í˜¸ ìª½ì´ ì•„ë‹ˆë¼ë©´) <b>ì›ì£¼ê°ì˜ í¬ê¸°ëŠ” í•­ìƒ ì¼ì •</b>í•©ë‹ˆë‹¤.<br>
                    ì  Pë¥¼ ë“œë˜ê·¸í•´ì„œ ì§ì ‘ í™•ì¸í•´ë³´ì„¸ìš”!
                </p>
            </div>
        </div>
    </div>

<script>
    const canvas = document.getElementById('geoCanvas');
    const ctx = canvas.getContext('2d');

    // ê³ í•´ìƒë„ ì²˜ë¦¬
    const WIDTH = 300;
    const HEIGHT = 300;
    const DPI = 2;
    canvas.width = WIDTH * DPI;
    canvas.height = HEIGHT * DPI;
    ctx.scale(DPI, DPI);

    // ì¤‘ì‹¬ ì¢Œí‘œ ë° ë°˜ì§€ë¦„
    const CX = WIDTH / 2;
    const CY = HEIGHT / 2;
    const R = 120; // ì›ì˜ ë°˜ì§€ë¦„

    // ì ë“¤ì˜ ê°ë„ (ë¼ë””ì•ˆ) - ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
    // 0ë„ëŠ” 3ì‹œ ë°©í–¥, ì‹œê³„ë°©í–¥ìœ¼ë¡œ ì¦ê°€
    let angleA = Math.PI * 0.8; // 144ë„ ìœ„ì¹˜
    let angleB = Math.PI * 2.2; // 396ë„ (36ë„) ìœ„ì¹˜
    let angleP = Math.PI * 1.5; // 270ë„ (ìœ„ìª½) ìœ„ì¹˜

    let draggingPoint = null; // 'A', 'B', 'P'

    // ë§ˆìš°ìŠ¤/í„°ì¹˜ ì´ë²¤íŠ¸
    function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        return {
            x: clientX - rect.left,
            y: clientY - rect.top
        };
    }

    function isNear(pos, angle) {
        const px = CX + R * Math.cos(angle);
        const py = CY + R * Math.sin(angle);
        const dist = Math.hypot(pos.x - px, pos.y - py);
        return dist < 20; // í„°ì¹˜ ë²”ìœ„ 20px
    }

    function updateAngle(pos) {
        // ì¤‘ì‹¬ì—ì„œ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ê¹Œì§€ì˜ ê°ë„ ê³„ì‚° (atan2)
        return Math.atan2(pos.y - CY, pos.x - CX);
    }

    canvas.addEventListener('mousedown', startDrag);
    canvas.addEventListener('touchstart', startDrag, {passive: false});
    document.addEventListener('mousemove', drag);
    document.addEventListener('touchmove', drag, {passive: false});
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);

    function startDrag(e) {
        const pos = getMousePos(e);
        if (isNear(pos, angleA)) draggingPoint = 'A';
        else if (isNear(pos, angleB)) draggingPoint = 'B';
        else if (isNear(pos, angleP)) draggingPoint = 'P';
        
        if(draggingPoint) e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
    }

    function drag(e) {
        if (!draggingPoint) return;
        e.preventDefault();
        const pos = getMousePos(e);
        const newAngle = updateAngle(pos);

        if (draggingPoint === 'A') angleA = newAngle;
        else if (draggingPoint === 'B') angleB = newAngle;
        else if (draggingPoint === 'P') angleP = newAngle;

        draw();
    }

    function endDrag() {
        draggingPoint = null;
    }

    // ê·¸ë¦¬ê¸° í•¨ìˆ˜ë“¤
    function draw() {
        ctx.clearRect(0, 0, WIDTH, HEIGHT);

        // 1. ì› ê·¸ë¦¬ê¸°
        ctx.beginPath();
        ctx.arc(CX, CY, R, 0, Math.PI * 2);
        ctx.lineWidth = 2;
        ctx.strokeStyle = '#dfe6e9';
        ctx.stroke();

        // ì¢Œí‘œ ê³„ì‚°
        const Ax = CX + R * Math.cos(angleA);
        const Ay = CY + R * Math.sin(angleA);
        const Bx = CX + R * Math.cos(angleB);
        const By = CY + R * Math.sin(angleB);
        const Px = CX + R * Math.cos(angleP);
        const Py = CY + R * Math.sin(angleP);

        // 2. ì¤‘ì‹¬ê° ì˜ì—­ (ë¶€ì±„ê¼´) ì±„ìš°ê¸° - ë¹¨ê°•
        // í•­ìƒ ì‘ì€ ìª½ ê°ì„ ì¹ í•˜ê¸° ìœ„í•´ ê³„ì‚°
        let startAngle = angleA;
        let endAngle = angleB;
        
        // ê°ë„ ì •ê·œí™” ë° ì‚¬ì´ê° ê³„ì‚°
        let diff = endAngle - startAngle;
        while (diff <= -Math.PI) diff += 2*Math.PI;
        while (diff > Math.PI) diff -= 2*Math.PI;

        ctx.beginPath();
        ctx.moveTo(CX, CY);
        // í˜¸ë¥¼ ê·¸ë¦´ ë•Œ ë°©í–¥ ì„¤ì • (ì‘ì€ ê° ìª½ìœ¼ë¡œ)
        if (diff > 0) {
            ctx.arc(CX, CY, R, startAngle, endAngle);
        } else {
            ctx.arc(CX, CY, R, startAngle, endAngle, true);
        }
        ctx.fillStyle = 'rgba(255, 118, 117, 0.2)'; // ì—°í•œ ë¹¨ê°•
        ctx.fill();

        // 3. ì„  ê·¸ë¦¬ê¸°
        // ì¤‘ì‹¬ê° ì„  (OA, OB)
        ctx.beginPath();
        ctx.moveTo(Ax, Ay); ctx.lineTo(CX, CY); ctx.lineTo(Bx, By);
        ctx.lineWidth = 3;
        ctx.strokeStyle = '#ff7675'; // ë¹¨ê°•
        ctx.stroke();

        // ì›ì£¼ê° ì„  (PA, PB)
        ctx.beginPath();
        ctx.moveTo(Ax, Ay); ctx.lineTo(Px, Py); ctx.lineTo(Bx, By);
        ctx.lineWidth = 3;
        ctx.strokeStyle = '#74b9ff'; // íŒŒë‘
        ctx.stroke();

        // 4. ì  ê·¸ë¦¬ê¸°
        drawPoint(CX, CY, 'O', '#2d3436');
        drawPoint(Ax, Ay, 'A', '#ff7675');
        drawPoint(Bx, By, 'B', '#ff7675');
        drawPoint(Px, Py, 'P', '#74b9ff');

        // 5. ê°ë„ ê³„ì‚° ë° í‘œì‹œ
        updateInfo(diff);
    }

    function drawPoint(x, y, label, color) {
        ctx.beginPath();
        ctx.arc(x, y, 6, 0, Math.PI * 2);
        ctx.fillStyle = color;
        ctx.fill();
        ctx.lineWidth = 2;
        ctx.strokeStyle = 'white';
        ctx.stroke();

        // ë¼ë²¨
        ctx.fillStyle = '#2d3436';
        ctx.font = 'bold 14px sans-serif';
        // ì¤‘ì‹¬ì—ì„œ ì  ë°©í–¥ìœ¼ë¡œ ì•½ê°„ ë„ì›Œì„œ ê¸€ì”¨ ì“°ê¸°
        const dx = x - CX;
        const dy = y - CY;
        const dist = Math.hypot(dx, dy);
        let lx = x, ly = y;
        
        if(dist > 0) {
            lx = x + (dx/dist) * 20;
            ly = y + (dy/dist) * 20;
        } else {
            ly += 20; // ì›ì 
        }
        
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(label, lx, ly);
    }

    function updateInfo(radDiff) {
        // ì¤‘ì‹¬ê° í¬ê¸° (í•­ìƒ ì–‘ìˆ˜, 0~180ë„ ì‚¬ì´ë¡œ í‘œí˜„)
        // ë§Œì•½ 180ë„ê°€ ë„˜ì–´ê°€ë©´ ë°˜ëŒ€ìª½ ê°ì„ ë³´ì—¬ì¤Œ (ë¬¸ì œ ë‹¨ìˆœí™”)
        let centerDeg = Math.abs(radDiff * 180 / Math.PI);
        if (centerDeg > 180) centerDeg = 360 - centerDeg;

        // ì›ì£¼ê° ê³„ì‚° (ë²¡í„° ë‚´ì  ì´ìš©)
        // PA ë²¡í„°, PB ë²¡í„°
        const Ax = R * Math.cos(angleA), Ay = R * Math.sin(angleA);
        const Bx = R * Math.cos(angleB), By = R * Math.sin(angleB);
        const Px = R * Math.cos(angleP), Py = R * Math.sin(angleP);

        const PA = { x: Ax - Px, y: Ay - Py };
        const PB = { x: Bx - Px, y: By - Py };

        const magPA = Math.hypot(PA.x, PA.y);
        const magPB = Math.hypot(PB.x, PB.y);

        // ë‚´ì  ê³µì‹: AÂ·B = |A||B|cosÎ¸
        let cosTheta = (PA.x * PB.x + PA.y * PB.y) / (magPA * magPB);
        // ë¶€ë™ì†Œìˆ˜ì  ì˜¤ì°¨ ë³´ì •
        if (cosTheta > 1) cosTheta = 1;
        if (cosTheta < -1) cosTheta = -1;

        let inscribedRad = Math.acos(cosTheta);
        let inscribedDeg = inscribedRad * 180 / Math.PI;

        // [êµìœ¡ì  ì²˜ë¦¬] 
        // ì  Pê°€ í˜¸ AB ìœ„ì— ìˆì–´ì„œ ì›ì£¼ê°ì´ ë‘”ê°ì´ ë˜ëŠ” ê²½ìš°(180 - ì¤‘ì‹¬ê°/2)ë„ ìˆìŒ
        // ì—¬ê¸°ì„œëŠ” 'ê°™ì€ í˜¸'ì— ëŒ€í•œ ì›ì£¼ê°ë§Œ ë‹¤ë£¨ëŠ” ê²Œ ì¼ë°˜ì ì´ë¯€ë¡œ
        // ê³„ì‚°ëœ ì›ì£¼ê°ì´ ì¤‘ì‹¬ê°ì˜ ì ˆë°˜ê³¼ ê·¼ì‚¬í•˜ë©´ ì ˆë°˜ ê°’ìœ¼ë¡œ ë”± ë–¨ì–´ì§€ê²Œ ë³´ì—¬ì¤Œ
        
        const halfCenter = centerDeg / 2;
        
        // í™”ë©´ í‘œì‹œìš© (ì†Œìˆ˜ì  ì œê±°)
        let displayCenter = Math.round(centerDeg);
        let displayInscribed = Math.round(inscribedDeg);

        // ë³´ì •: ë§Œì•½ Pê°€ minor arcì— ìˆì–´ì„œ ê°ì´ í•©ì³ì„œ 180ë„ê°€ ë˜ëŠ” ìƒí™©ì´ë©´
        // ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ê³ , major arcì— ìˆì–´ì„œ 1/2 ê´€ê³„ë©´ ì •í™•íˆ 1/2ë¡œ ë³´ì—¬ì¤Œ.
        // (ì‚¬ìš©ìê°€ í—·ê°ˆë¦¬ì§€ ì•Šê²Œ ì˜¤ì°¨ ë¬´ì‹œ)
        if (Math.abs(displayInscribed - displayCenter/2) < 2) {
            displayInscribed = displayCenter / 2; // ì •í™•íˆ ì ˆë°˜ìœ¼ë¡œ í‘œì‹œ
        }

        document.getElementById('centerAngle').innerText = displayCenter + "Â°";
        document.getElementById('inscribedAngle').innerText = displayInscribed + "Â°";
        
        // Pê°€ ë°˜ëŒ€í¸(minor arc)ìœ¼ë¡œ ë„˜ì–´ê°€ë©´ ë¹¨ê°„ ê²½ê³ ? (ì„ íƒì‚¬í•­)
        // ì¼ë‹¨ì€ ìˆëŠ” ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ íƒêµ¬ì— ì¢‹ìŒ
    }

    function toggleConcept() {
        const btn = document.querySelector('.concept-btn');
        const content = document.getElementById('conceptBox');
        btn.classList.toggle('active');
        if (content.style.maxHeight) {
            content.style.maxHeight = null; 
        } else {
            content.style.maxHeight = content.scrollHeight + "px"; 
        }
    }

    // ì´ˆê¸° ê·¸ë¦¬ê¸°
    draw();

</script>
</body>
</html>
