<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¢Œí‘œí‰ë©´ ë³´ë¬¼ì°¾ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Jua', sans-serif;
            margin: 0; padding: 0;
            background-color: #f0f4f8;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh;
        }

        /* ìƒë‹¨ í—¤ë” */
        header {
            background-color: #343a40; color: white; width: 100%;
            padding: 15px 0; display: flex; justify-content: center; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); position: relative;
        }
        .home-btn {
            position: absolute; left: 20px;
            background: transparent; border: 2px solid white; color: white;
            padding: 5px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; font-family: 'Jua';
        }
        .home-btn:hover { background: white; color: #333; }
        h1 { margin: 0; font-size: 1.5rem; }

        /* ë©”ì¸ ì»¨í…ì¸  */
        .container {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; flex: 1; width: 100%; padding: 20px;
        }

        /* ìº”ë²„ìŠ¤ (ì¢Œí‘œí‰ë©´) */
        .canvas-wrapper {
            background: white; border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 10px; margin-bottom: 20px;
            /* ìº”ë²„ìŠ¤ í¬ê¸° ê°•ì œ ê³ ì • (ë ˆì´ì•„ì›ƒ í‹€ì–´ì§ ë°©ì§€) */
            width: 340px; 
            height: 340px;
            display: flex; justify-content: center; align-items: center;
        }
        
        canvas { 
            /* í…Œë‘ë¦¬ì™€ ë°°ê²½ */
            border: 1px solid #ddd; 
            background-color: #fff; 
            /* ì¤‘ìš”: CSSë¡œ ë³´ì´ëŠ” í¬ê¸°ë¥¼ ëª…í™•íˆ ì§€ì • */
            width: 340px; 
            height: 340px;
        }

        /* ì…ë ¥ ì»¨íŠ¸ë¡¤ */
        .control-panel {
            background: white; padding: 20px; border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex; gap: 10px; align-items: center; flex-wrap: wrap; justify-content: center;
        }
        .input-group { display: flex; align-items: center; font-size: 1.5rem; font-weight: bold; }
        input[type="number"] {
            width: 60px; height: 40px; font-size: 1.2rem; text-align: center;
            border: 2px solid #ddd; border-radius: 8px; margin: 0 5px;
            font-family: 'Jua';
        }
        input:focus { border-color: #4a69bd; outline: none; }

        .btn {
            padding: 10px 20px; font-size: 1.2rem; border: none; border-radius: 10px;
            cursor: pointer; color: white; font-family: 'Jua'; transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-check { background-color: #27ae60; }
        .btn-skip { background-color: #e67e22; }

        /* ì ìˆ˜íŒ */
        .score-board {
            margin-top: 20px; font-size: 1.2rem; color: #2c3e50;
            background: #dfe6e9; padding: 10px 20px; border-radius: 20px;
        }

        /* ê²°ê³¼ ëª¨ë‹¬ */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-content { background: white; padding: 30px; border-radius: 15px; text-align: center; width: 300px; }
        .modal-content h2 { margin-top: 0; }
        .modal-btn { background-color: #4a69bd; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-family: 'Jua'; font-size: 1.2rem; }

    </style>
</head>
<body>

    <header>
        <button class="home-btn" onclick="location.href='../index.html'">ğŸ  í™ˆ</button>
        <h1>ğŸ“ ì¢Œí‘œë¥¼ ì°¾ì•„ë¼!</h1>
    </header>

    <div class="container">
        <div class="score-board">
            ë§ì¶˜ ê°œìˆ˜: <span id="score">0</span> | ì—°ì† ì •ë‹µ: <span id="streak">0</span>
        </div>

        <div class="canvas-wrapper">
            <canvas id="graphCanvas"></canvas>
        </div>

        <div class="control-panel">
            <div class="input-group">
                ( <input type="number" id="inputX" placeholder="x"> , 
                  <input type="number" id="inputY" placeholder="y"> )
            </div>
            <button class="btn btn-check" onclick="checkAnswer()">í™•ì¸</button>
            <button class="btn btn-skip" onclick="generateProblem()">íŒ¨ìŠ¤</button>
        </div>
    </div>

    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2 id="modalTitle">ì •ë‹µ! ğŸ‰</h2>
            <p id="modalMsg">ì •í™•í•œ ì¢Œí‘œì…ë‹ˆë‹¤.</p>
            <button class="modal-btn" onclick="closeModal()">ë‹¤ìŒ ë¬¸ì œ</button>
        </div>
    </div>

<script>
    const canvas = document.getElementById('graphCanvas');
    const ctx = canvas.getContext('2d');
    
    // [í•´ê²° 2] ê³ í•´ìƒë„(Retina) ì§€ì›: í”½ì…€ ë°€ë„ì— ë§ì¶° ìº”ë²„ìŠ¤ ë‚´ë¶€ í¬ê¸° ë»¥íŠ€ê¸°
    const LOGICAL_SIZE = 340; // ìš°ë¦¬ ëˆˆì— ë³´ì´ëŠ” í¬ê¸°
    const dpr = window.devicePixelRatio || 1; // ê¸°ê¸° ë°°ìœ¨ (ë³´í†µ 2 ì´ìƒ)
    
    // ìº”ë²„ìŠ¤ì˜ 'ì‹¤ì œ í”½ì…€ ìˆ˜'ë¥¼ ëŠ˜ë¦¼
    canvas.width = LOGICAL_SIZE * dpr;
    canvas.height = LOGICAL_SIZE * dpr;
    
    // ìº”ë²„ìŠ¤ì˜ 'í™”ë©´ í‘œì‹œ í¬ê¸°'ëŠ” ê³ ì •
    canvas.style.width = LOGICAL_SIZE + 'px';
    canvas.style.height = LOGICAL_SIZE + 'px';

    // ê·¸ë¦¬ê¸° ë„êµ¬ì˜ ë°°ìœ¨ì„ ì¡°ì •í•´ì„œ, ìš°ë¦¬ê°€ ì¢Œí‘œë¥¼ 1ë§Œí¼ ì´ë™í•´ë„ ì‹¤ì œë¡œëŠ” dprë§Œí¼ ì´ë™í•˜ê²Œ í•¨
    ctx.scale(dpr, dpr);
    
    // ì„¤ì •ê°’
    const RANGE = 10; 
    const GRID_SIZE = LOGICAL_SIZE / (RANGE * 2 + 2); 
    const CENTER = LOGICAL_SIZE / 2;
    
    let targetX = 0;
    let targetY = 0;
    let score = 0;
    let streak = 0;
    
    // [í•´ê²° 1] ì¤‘ë³µ ì •ë‹µ ë°©ì§€ë¥¼ ìœ„í•œ ìƒíƒœ ë³€ìˆ˜
    let isGameActive = true; 

    // 1. ë¬¸ì œ ìƒì„±
    function generateProblem() {
        do {
