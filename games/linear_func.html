<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¼ì°¨í•¨ìˆ˜ ì •ë³µ | Linear Function Conquest</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        /* 1. ê³µí†µ ì„¤ì • */
        body {
            font-family: 'Jua', sans-serif;
            margin: 0; padding: 0;
            background: radial-gradient(circle at 50% 30%, #74b9ff, #0984e3);
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
            user-select: none;
        }

        /* 2. í—¤ë” */
        header {
            background: rgba(255, 255, 255, 0.9);
            width: 100%; padding: 15px 0;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative;
        }
        .home-btn {
            position: absolute; left: 20px;
            background: #2d3436; color: white; border: none;
            padding: 8px 15px; border-radius: 20px; cursor: pointer; 
            font-family: 'Jua'; text-decoration: none;
        }
        h1 { margin: 0; font-size: 1.8rem; color: #2d3436; }

        /* 3. ê²Œì„ ì˜ì—­ */
        .container {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; width: 100%; max-width: 500px;
            padding: 20px; box-sizing: border-box;
        }

        .score-board {
            background: rgba(255,255,255,0.2); color: white;
            padding: 10px 25px; border-radius: 30px; margin-bottom: 20px;
            font-size: 1.2rem; border: 2px solid white;
        }

        /* ìº”ë²„ìŠ¤ ë˜í¼ */
        .canvas-wrapper {
            background: white; border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            padding: 15px; /* íŒ¨ë”© ìµœì†Œí™” */
            margin-bottom: 20px;
        }
        /* ìº”ë²„ìŠ¤ í¬ê¸° CSSë¡œ ëª…ì‹œ */
        canvas { display: block; background: #fff; border-radius: 10px; }

        /* ì…ë ¥ í¼ */
        .input-area {
            background: white; padding: 20px 30px; border-radius: 25px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
            display: flex; align-items: center; justify-content: center; gap: 10px;
            flex-wrap: wrap; font-size: 1.5rem; color: #2d3436;
        }
        
        input[type="text"] {
            width: 70px; height: 50px; text-align: center;
            font-size: 1.5rem; font-family: 'Jua';
            border: 3px solid #dfe6e9; border-radius: 10px; outline: none;
            color: #0984e3; transition: 0.2s;
        }
        input[type="text"]:focus { border-color: #0984e3; }

        .submit-btn {
            width: 100%; margin-top: 15px;
            background: #00cec9; color: white; border: none;
            padding: 15px; font-size: 1.4rem; border-radius: 15px;
            cursor: pointer; font-family: 'Jua';
            box-shadow: 0 5px 0 #00b894; transition: 0.1s;
        }
        .submit-btn:active { transform: translateY(5px); box-shadow: none; }

        /* 4. ê²°ê³¼ ëª¨ë‹¬ */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-content { 
            background: white; padding: 30px; border-radius: 25px; 
            text-align: center; width: 320px; 
            box-shadow: 0 15px 30px rgba(0,0,0,0.3); border: 4px solid #0984e3;
            animation: popIn 0.3s;
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .modal-content h2 { margin-top: 0; }
        
        .modal-btn-group {
            display: flex; gap: 10px; justify-content: center; margin-top: 20px;
        }
        .modal-btn { 
            background-color: #0984e3; color: white; padding: 10px 20px; 
            border: none; border-radius: 20px; cursor: pointer; 
            font-family: 'Jua'; font-size: 1.1rem; flex: 1;
            box-shadow: 0 4px 0 #0652dd;
        }
        .modal-btn:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-retry { background-color: #fdcb6e; color: #2d3436; box-shadow: 0 4px 0 #e1b12c; }
        .btn-check { background-color: #d63031; color: white; box-shadow: 0 4px 0 #c0392b; }

    </style>
</head>
<body>

    <header>
        <a href="../../index.html" class="home-btn">ğŸ  í™ˆ</a>
        <h1>ğŸ“ˆ ì¼ì°¨í•¨ìˆ˜ ì •ë³µ</h1>
    </header>

    <div class="container">
        <div class="score-board">
            ë§ì¶˜ ë¬¸ì œ: <span id="score">0</span>
        </div>

        <div class="canvas-wrapper">
            <canvas id="graphCanvas" width="640" height="640" style="width:320px; height:320px;"></canvas>
        </div>

        <div class="input-area">
            <span>y = </span>
            <input type="text" id="inputA" placeholder="a">
            <span>x + </span>
            <input type="text" id="inputB" placeholder="b">
            <button class="submit-btn" onclick="checkAnswer()">ì •ë‹µ í™•ì¸!</button>
        </div>
        <div style="margin-top:10px; color:white; font-size:0.9rem; opacity:0.9;">
            * ë¶„ìˆ˜ëŠ” '1/2' ì²˜ëŸ¼ ì…ë ¥í•˜ì„¸ìš”.
        </div>
    </div>

    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2 id="modalTitle">ì •ë‹µ! ğŸ‰</h2>
            <div id="modalMsg" style="font-size: 1.1rem; line-height: 1.6; color: #555;">ì •í™•í•©ë‹ˆë‹¤!</div>
            <div class="modal-btn-group" id="modalBtns">
                <button class="modal-btn" onclick="nextProblem()">ë‹¤ìŒ ë¬¸ì œ ğŸ‘‰</button>
            </div>
        </div>
    </div>
<section style="max-width: 700px; margin: 40px auto; padding: 30px; background: white; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: #2d3436;">
        
        <h2 style="border-bottom: 3px solid #74b9ff; padding-bottom: 10px; margin-bottom: 20px;">ğŸ“˜ ì„ ìƒë‹˜ì˜ ê°œë… ë…¸íŠ¸</h2>
        
        <div style="line-height: 1.8; font-size: 1.1rem;">
            <h3 style="color: #0984e3;">1. ì¼ì°¨í•¨ìˆ˜ì˜ ê¸°ë³¸í˜•</h3>
            <p>
                ì¼ì°¨í•¨ìˆ˜ëŠ” ë³´í†µ <b>y = ax + b</b> í˜•íƒœë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br>
                ì—¬ê¸°ì„œ <b>aëŠ” ê¸°ìš¸ê¸°</b>, <b>bëŠ” yì ˆí¸</b>ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
            </p>

            <h3 style="color: #0984e3; margin-top: 25px;">2. ê·¸ë˜í”„ ë³´ëŠ” ë²• (ê²Œì„ ê³µëµ!)</h3>
            <ul style="list-style-type: none; padding-left: 0;">
                <li style="margin-bottom: 10px;">
                    ğŸ¯ <b>yì ˆí¸(b) ì°¾ê¸°:</b> yì¶•ê³¼ ë§Œë‚˜ëŠ” ì ì„ ë¨¼ì € ë³´ì„¸ìš”. ê·¸ ì ì˜ ìˆ«ìê°€ ë°”ë¡œ bì…ë‹ˆë‹¤.
                </li>
                <li>
                    ğŸ“ˆ <b>ê¸°ìš¸ê¸°(a) ì°¾ê¸°:</b> ê·¸ë˜í”„ê°€ ì˜¤ë¥¸ìª½ ìœ„ë¡œ ê°€ë©´ (+), ì˜¤ë¥¸ìª½ ì•„ë˜ë¡œ ê°€ë©´ (-)ì…ë‹ˆë‹¤. xê°€ 1 ì¦ê°€í•  ë•Œ yê°€ ì–¼ë§Œí¼ ë³€í•˜ëŠ”ì§€ ì„¸ì–´ë³´ì„¸ìš”!
                </li>
            </ul>

            <div style="background: #dfe6e9; padding: 15px; border-radius: 10px; margin-top: 20px; font-size: 0.95rem;">
                ğŸ’¡ <b>Tip:</b> ë¬¸ì œë¥¼ í‹€ë ¤ë„ ê´œì°®ì•„ìš”. 'ë‹¤ì‹œ í’€ê¸°'ë¥¼ ëˆŒëŸ¬ì„œ ëˆê¸° ìˆê²Œ ë„ì „í•´ë³´ì„¸ìš”!
            </div>
        </div>

    </section>
    
<script>
    const canvas = document.getElementById('graphCanvas');
    const ctx = canvas.getContext('2d');
    
    // [ìˆ˜ì •] ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ 320pxë¡œ ì„¤ì •í•˜ê³  ì—¬ë°± ì—†ì´ ê½‰ ì±„ì›€
    const WIDTH = 320; 
    const HEIGHT = 320; 
    ctx.scale(2, 2); 

    const CENTER_X = WIDTH / 2;
    const CENTER_Y = HEIGHT / 2;
    
    const GRID_COUNT = 10; // -10 ~ 10 (ì´ 20ì¹¸)
    
    // [í•µì‹¬] ì „ì²´ ë„ˆë¹„ë¥¼ 20ì¹¸ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëˆˆê¸ˆ í¬ê¸° ê³„ì‚° (ì—¬ë°± ì—†ìŒ)
    const SCALE = WIDTH / (GRID_COUNT * 2); 

    let answerA = 0; 
    let answerB = 0; 
    let score = 0;

    // 1. ë¬¸ì œ ìƒì„±
    function generateProblem() {
        answerB = Math.floor(Math.random() * 17) - 8;
        const niceSlopes = [
            1, -1, 2, -2, 3, -3,     
            0.5, -0.5, 1/3, -1/3,    
            2/3, -2/3, 1.5, -1.5     
        ];
        answerA = niceSlopes[Math.floor(Math.random() * niceSlopes.length)];

        document.getElementById('inputA').value = '';
        document.getElementById('inputB').value = '';
        document.getElementById('inputA').focus();

        drawGraph();
    }

    // 2. ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
    function drawGraph() {
        ctx.clearRect(0, 0, WIDTH, HEIGHT);

        // [ëª¨ëˆˆì¢…ì´] - ìº”ë²„ìŠ¤ ëê¹Œì§€ ê½‰ ì°¨ê²Œ ê·¸ë¦¼
        ctx.strokeStyle = '#dfe6e9'; 
        ctx.lineWidth = 1;
        ctx.beginPath();

        // ìˆ˜ì§ì„ 
        for (let i = -GRID_COUNT; i <= GRID_COUNT; i++) {
            let x = CENTER_X + i * SCALE;
            // 0.5í”½ì…€ ë³´ì •ìœ¼ë¡œ ì„ ëª…í•˜ê²Œ
            x = Math.round(x) + 0.5; 
            ctx.moveTo(x, 0); ctx.lineTo(x, HEIGHT);
        }
        // ìˆ˜í‰ì„ 
        for (let i = -GRID_COUNT; i <= GRID_COUNT; i++) {
            let y = CENTER_Y - i * SCALE;
            y = Math.round(y) + 0.5;
            ctx.moveTo(0, y); ctx.lineTo(WIDTH, y);
        }
        ctx.stroke();

        // [ì¶• ê·¸ë¦¬ê¸°]
        ctx.strokeStyle = '#2d3436';
        ctx.lineWidth = 2;
        ctx.beginPath();
        
        // xì¶• (ëê¹Œì§€)
        ctx.moveTo(0, CENTER_Y); ctx.lineTo(WIDTH, CENTER_Y);
        // í™”ì‚´í‘œ
        ctx.moveTo(WIDTH, CENTER_Y); ctx.lineTo(WIDTH - 8, CENTER_Y - 4);
        ctx.moveTo(WIDTH, CENTER_Y); ctx.lineTo(WIDTH - 8, CENTER_Y + 4);

        // yì¶• (ëê¹Œì§€)
        ctx.moveTo(CENTER_X, HEIGHT); ctx.lineTo(CENTER_X, 0);
        // í™”ì‚´í‘œ
        ctx.moveTo(CENTER_X, 0); ctx.lineTo(CENTER_X - 4, 8);
        ctx.moveTo(CENTER_X, 0); ctx.lineTo(CENTER_X + 4, 8);
        ctx.stroke();

        // [í…ìŠ¤íŠ¸ í‘œì‹œ]
        ctx.fillStyle = '#2d3436';
        ctx.font = 'bold 12px sans-serif';
        
        // ì›ì 
        ctx.textAlign = 'right'; ctx.textBaseline = 'top';
        ctx.fillText('O', CENTER_X - 5, CENTER_Y + 5);
        
        // [ìˆ˜ì •] ì¶• ì´ë¦„ ìœ„ì¹˜ (xë¥¼ ìœ„ë¡œ, yë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ)
        ctx.textAlign = 'right'; ctx.textBaseline = 'bottom';
        ctx.fillText('x', WIDTH - 5, CENTER_Y - 5); // xì¶• ìœ„
        
        ctx.textAlign = 'left'; ctx.textBaseline = 'top';
        ctx.fillText('y', CENTER_X + 5, 5); // yì¶• ì˜†

        // [ìˆ«ì í‘œì‹œ] - ìº”ë²„ìŠ¤ ëì— ë‹¿ì§€ ì•Šê²Œ ì•½ê°„ ì•ˆìª½ìœ¼ë¡œ
        ctx.textAlign = 'center'; ctx.textBaseline = 'top';
        ctx.fillText('5', CENTER_X + 5 * SCALE, CENTER_Y + 5);
        ctx.fillText('10', WIDTH - 10, CENTER_Y + 5); // ëë¶€ë¶„ ì¡°ì •
        ctx.fillText('-5', CENTER_X - 5 * SCALE, CENTER_Y + 5);
        ctx.fillText('-10', 10, CENTER_Y + 5); // ëë¶€ë¶„ ì¡°ì •

        ctx.textAlign = 'right'; ctx.textBaseline = 'middle';
        ctx.fillText('5', CENTER_X - 5, CENTER_Y - 5 * SCALE);
        ctx.fillText('10', CENTER_X - 5, 10); // ëë¶€ë¶„ ì¡°ì •
        ctx.fillText('-5', CENTER_X - 5, CENTER_Y + 5 * SCALE);
        ctx.fillText('-10', CENTER_X - 5, HEIGHT - 10); // ëë¶€ë¶„ ì¡°ì •

        // [í•¨ìˆ˜ ê·¸ë˜í”„]
        ctx.strokeStyle = '#e84118'; 
        ctx.lineWidth = 3;
        ctx.beginPath();

        // ìº”ë²„ìŠ¤ ì „ì²´ ì˜ì—­ì„ ë®ë„ë¡ ì¶©ë¶„íˆ ê¸¸ê²Œ ê·¸ë¦¼
        let startX = -GRID_COUNT - 5; 
        let startY = answerA * startX + answerB;
        let endX = GRID_COUNT + 5;
        let endY = answerA * endX + answerB;

        ctx.moveTo(CENTER_X + startX * SCALE, CENTER_Y - startY * SCALE);
        ctx.lineTo(CENTER_X + endX * SCALE, CENTER_Y - endY * SCALE);
        ctx.stroke();
    }

    // 3. ì •ë‹µ í™•ì¸
    function checkAnswer() {
        const userA_str = document.getElementById('inputA').value.trim();
        const userB_str = document.getElementById('inputB').value.trim();

        const userA = parseFraction(userA_str);
        const userB = parseFraction(userB_str);

        if (isNaN(userA) || isNaN(userB)) {
            alert("ìˆ«ìë‚˜ ë¶„ìˆ˜(ì˜ˆ: 1/2)ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
            return;
        }

        const modal = document.getElementById('resultModal');
        const title = document.getElementById('modalTitle');
        const msg = document.getElementById('modalMsg');
        const btnGroup = document.getElementById('modalBtns');

        const epsilon = 0.01;
        const isCorrect = Math.abs(userA - answerA) < epsilon && Math.abs(userB - answerB) < epsilon;

        if (isCorrect) {
            score++;
            document.getElementById('score').innerText = score;
            title.innerText = "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰";
            title.style.color = "#00cec9";
            let aDisplay = formatNumber(answerA);
            msg.innerHTML = `ì •í™•í•©ë‹ˆë‹¤!<br>ì •ë‹µ ì‹: <b>y = ${aDisplay}x + ${answerB}</b>`;
            btnGroup.innerHTML = `<button class="modal-btn" onclick="nextProblem()">ë‹¤ìŒ ë¬¸ì œ ğŸ‘‰</button>`;
        } else {
            title.innerText = "ì•„ì‰¬ì›Œìš” ğŸ˜¢";
            title.style.color = "#d63031";
            msg.innerHTML = "ë‹µì´ í‹€ë ¸ìŠµë‹ˆë‹¤.<br>ë‹¤ì‹œ í•œë²ˆ í’€ì–´ë³´ì‹œê² ì–´ìš”?";
            btnGroup.innerHTML = `
                <button class="modal-btn btn-retry" onclick="closeModal()">ë‹¤ì‹œ í’€ê¸° âœï¸</button>
                <button class="modal-btn btn-check" onclick="showAnswer()">ë‹µ í™•ì¸í•˜ê¸° ğŸ‘€</button>
            `;
        }
        modal.style.display = 'flex';
    }

    function showAnswer() {
        const title = document.getElementById('modalTitle');
        const msg = document.getElementById('modalMsg');
        const btnGroup = document.getElementById('modalBtns');
        title.innerText = "ì •ë‹µ í™•ì¸";
        title.style.color = "#2d3436";
        let aDisplay = formatNumber(answerA);
        msg.innerHTML = `ì •ë‹µì€ <b style="color:#d63031">y = ${aDisplay}x + ${answerB}</b> ì˜€ìŠµë‹ˆë‹¤.`;
        btnGroup.innerHTML = `<button class="modal-btn" onclick="nextProblem()">ë‹¤ìŒ ë¬¸ì œ ğŸ‘‰</button>`;
    }

    function closeModal() {
        document.getElementById('resultModal').style.display = 'none';
        document.getElementById('inputA').focus();
    }

    function parseFraction(str) {
        if (!str) return NaN;
        if (str.includes('/')) {
            const parts = str.split('/');
            if (parts.length === 2) return parseFloat(parts[0]) / parseFloat(parts[1]);
        }
        return parseFloat(str);
    }

    function formatNumber(decimal) {
        if (Math.abs(decimal - 0.5) < 0.001) return "1/2";
        if (Math.abs(decimal + 0.5) < 0.001) return "-1/2";
        if (Math.abs(decimal - 1/3) < 0.001) return "1/3";
        if (Math.abs(decimal + 1/3) < 0.001) return "-1/3";
        if (Math.abs(decimal - 2/3) < 0.001) return "2/3";
        if (Math.abs(decimal + 2/3) < 0.001) return "-2/3";
        if (Math.abs(decimal - 1.5) < 0.001) return "3/2";
        if (Math.abs(decimal + 1.5) < 0.001) return "-3/2";
        return Number.isInteger(decimal) ? decimal : decimal.toFixed(2);
    }

    function nextProblem() {
        closeModal();
        generateProblem();
    }

    generateProblem();

</script>
</body>
</html>
